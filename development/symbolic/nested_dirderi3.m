function y=dirderi(i,x,vinp,p)
sel=@(x0,y0)bsxfun(@(x,y)x(y),x0,y0);
v01=@(t)sel(vinp(0,t),1);
v11=@(t)sel(vinp(1,t),1);
v21=@(t)sel(vinp(2,t),1);
v31=@(t)sel(vinp(3,t),1);
v41=@(t)sel(vinp(4,t),1);
v51=@(t)sel(vinp(5,t),1);
switch i
case 1
y = [-v01(-p(1) - (p(2) * x(1) + 1) * x(1))];
case 2
t1 = (p(2) * x(1));
t2 = (1 + t1) * x(1) + p(1);
y = [-2 * v11(-t2) * v01(-t2) * (-1 - 2 * t1)];
case 3
t1 = (p(2) * x(1));
t2 = (1 + t1) * x(1) + p(1);
t3 = v01(-t2);
t4 = t3 * (-1 - 2 * t1);
t5 = v11(-t2);
t6 = t5 * t4;
t7 = -3;
y = [t7 * (v21(-t2) * t4 ^ 2 + t5 * (-2 * p(2) * t3 ^ 2 - 4 * t6 * t1 - 2 * t6))];
case 4
t1 = (p(2) * x(1));
t2 = (1 + t1) * x(1) + p(1);
t3 = v01(-t2);
t4 = -1 - 2 * t1;
t5 = t3 * t4;
t6 = v21(-t2);
t7 = v11(-t2);
t8 = p(2) * t3 ^ 2;
t9 = t7 * t5;
t4 = t7 * v01(0) * t4;
t10 = t5 ^ 2;
y = [-4 * v31(-t2) * t5 * t10 - 4 * t7 * ((-3 - 6 * t1) * (t6 * t10 + t7 * (-4 * t4 * t1 - 2 * t4 - 2 * t8)) - 12 * t9 * p(2) * t3) - 12 * t6 * t5 * (-4 * t9 * t1 - 2 * t8 - 2 * t9)];
case 5
t1 = (p(2) * x(1));
t2 = (1 + t1) * x(1) + p(1);
t3 = v31(-t2);
t4 = v01(-t2);
t5 = -2;
t6 = t1 * t5;
t7 = -1 + t6;
t8 = t4 * t7;
t9 = v11(-t2);
t10 = p(2) * t4 ^ 2;
t11 = t9 * t8;
t12 = t5 * (t10 + t11) - 4 * t11 * t1;
t13 = v21(-t2);
t14 = v01(0);
t7 = t14 * t7;
t15 = t9 * t7;
t10 = t5 * (t10 + t15) - 4 * t15 * t1;
t15 = t8 ^ 2;
t16 = t10 * t9 + t13 * t15;
t17 = 3 * t13 * t7 ^ 2;
t14 = 6 * t14 ^ 2;
t5 = 4 * t3 * t8 * t15 + 4 * t9 * ((t9 * (-12 * t4 * t7 + t14) + (-t14 * t9 * p(2) + t17) * t5 * x(1)) * p(2) - t17);
t7 = 12 * t13 * t8 * t10;
t10 = -5;
y = [t13 * (-15 * t12 ^ 2 - 20 * t8 * (t16 * (-3 - 6 * t1) - 12 * t11 * p(2) * t4)) + t10 * (t9 * (-24 * p(2) * (t15 * t9 ^ 2 + t16 * t4) - t5 - t7 + t6 * (t5 + t7)) + v41(-t2) * t15 ^ 2) - 30 * t3 * t15 * t12];
end
end
